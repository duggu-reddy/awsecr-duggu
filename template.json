{
	"Parameters": {
		"Cluster": {
			"Type": "String"
		},
		"DesiredCount": {
			"Type": "String"
		},
		"Role": {
			"Type": "String"
		},
		"TargetGroupArn": {
			"Type": "String"
		},
		"Image": {
			"Type": "String"
		}
	},
	"Resources": {
		"Services": {
			"Type": "AWS::ECS::Service",
			"Properties": {
				"Cluster": { "Ref" : "Cluster" },
				"DesiredCount": 2,
				"NetworkConfiguration": {
					"AwsvpcConfiguration": {
						"AssignPublicIp": "ENABLED",
						"Subnets": [
							"subnet-18acc844"
						]
					}
				},
				"TaskDefinition": {"Ref":"TaskDefinition"},
				"LaunchType": "FARGATE",
				"LoadBalancers": [
					{
						"ContainerName": "node",
						"ContainerPort": 80,
						"TargetGroupArn": { "Ref" : "TargetGroupArn"}
					}
				]
			}
		},
		"TaskDefinition": {
			"Type": "AWS::ECS::TaskDefinition",
			"Properties": {
				"Family": "Service",
				"Cpu": 256,
				"Memory": 512,
				"NetworkMode": "awsvpc",
				"ExecutionRoleArn": {"Ref" : "Role"},
				"RequiresCompatibilities": [
					"FARGATE"
				],
				"ContainerDefinitions": [
					{
						"Name": "node",
						"Image": { "Ref" : "Image"},
						"Memory": 512,
						"PortMappings": [
							{
								"ContainerPort": 80
							}
						]
					}
				]
			}
		}
	}
}